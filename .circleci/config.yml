version: 2.1
jobs:
  build:
    docker:
      - image: circleci/python:3.7.2
    steps:
      - run:
          command: |
            curl -s https://packagecloud.io/install/repositories/github/git-lfs/script.deb.sh | sudo bash
            sudo apt-get install git-lfs
      - run:
          command: |
            git clone --branch=master --depth 10 --recurse-submodules https://android.googlesource.com/platform/superproject
            cd superproject
            git lfs fetch --all
      - run:
          command: |
            cd superproject
            git count-objects -v -H
      - run:
          command: |
            cd superproject
            wget https://github.com/github/git-sizer/releases/download/v1.3.0/git-sizer-1.3.0-linux-386.zip
            mkdir git_size
            unzip -qq git-sizer-1.3.0-linux-386.zip -d git_size
            export PATH='pwd'/git_size:$PATH
            chmod +x git_size/git-sizer
            ./git_size/git-sizer --verbose



   

